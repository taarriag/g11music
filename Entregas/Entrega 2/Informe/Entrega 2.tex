\documentclass[11pt,letterpaper]{article}
\usepackage[spanish]{babel} %idioma
\usepackage[latin1]{inputenc}
\usepackage{graphicx}
\usepackage{anysize} %Permitir distintas medidas de margenes

% Configuración PDF
\usepackage[pdftex]{hyperref}
\hypersetup{
    %bookmarks=true,
    pdfborder={0 0 0},
    pdfstartview=FitH,
    pdftitle={Arquitectura de computadores},
    pdfsubject={Entrega 2},
    pdfauthor={G11}
}

\marginsize{3cm}{2cm}{2cm}{4cm}

% $Rev: 595 $
\title{\Huge \textbf{Arquitectura de Computadores}\\\Huge \textbf{Proyecto: SmartMusic}\\\Large \textbf{Entrega 2}}
\author{Grupo G11}
\date{4 de Octubre de 2009}
\begin{document}

\maketitle

\bigskip 
\textbf{Integrantes:}
\begin{itemize}
\item Pablo Alcayaga
\item Tomás Arriagada
\item Felipe Balbontín
\item Gabriel Diéguez
\item Javier Espinosa
\item Sebastián Vicencio
\end{itemize}

\newpage
%Tabla de contenidos y figuras. Recomendamos no tocar
\tableofcontents
\listoffigures

\newpage
\section{Introducción}
describir el dispositivo que estamos haciendo(juntar los primeros parrafos de nuestro informe pasado)\\
describir lo que hicimos en esta entrega(el diseño y todo eso, pero por encima, después se profundiza en este informe)\\
describir las exigencias para el circuito (o sea poner la lista que aparece en el enunciado que tiene que es lo que debe hacer nuestro circuito: entradas análoga, interrupciones, el pic, etc)\\




\section{Descripción del Diseño}
introducción a esta parte, cuales son los componentes a conectar. y su funcionalidad\\

\subsection{Diagrama del circuito}
explicar los diagramas. señalar que se tiene el diagrama de la placa controladora, con todas las conexiones y de manera independiente se tiene otro diagrama con las conexiones que vamos a implementar (osea, en el otro diagrama no tenemos las conexiones del pic a implementar).

\subsection{Descripción de los componentes:}
A continuación se describen los componentes a utilizar y la forma en que serán utilizados por nuestro circuito. 

línea introductoria\\

en esta parte, al describir el dispositivo asociado a uno de los requisitos (PWM, entrada analoga, interrupción) describir cómo esta satisface al requisito\\

\subsubsection{Dispositivos análogos:}
Nuestro sistema utilizará dispositivos análogos para capturar información del ambiente, en particular, el nivel de sonido y la intensidad lumínica.


\textbf{1.Sensor de sonido (\emph{ZX-Sound})}\\

	\begin{itemize}
		\item Descripción: Este componente detecta el nivel de sonido del ambiente y genera un voltaje correspondiente cuyo valor fluctúa entre 0V y 5V.
		\item Requisitos asociados: Entrada análoga y PWM para la conversión analógica digital del voltaje entregado por el componente.
		\item Conexión al PIC: Puerto AN0 para leer el voltaje generado desde el componente.
	\end{itemize}


\textbf{2.Sensor de luminosidad (\emph{ZX-LDR})}

	\begin{itemize}
		\item Descripción: Este componente detecta el nivel de la intensidad lumínica del ambiente y genera un voltaje correspondiente cuyo valor fluctúa entre 0V y 5V.
		\item Requisitos asociados: Entrada análoga y PWM para la conversión analógica digital del voltaje entregado por el componente.
		\item Conexión al PIC: Puerto AN1 para leer el voltaje generado desde el componente.
	\end{itemize}


\subsubsection{\textsl{Display} LCD}
Este componente será utilizado con el fin de mostrar información sobre la canción actual que se está reproduciendo en el computador conectado al dispositivo. Además indicará el valor actual del \textsl{timer} que permite apagar automáticamente el dispositivo transcurrido cierto tiempo.


\subsubsection{Pulsadores}

\subsubsection{PIC}
aquí escribir todas las piezas asociadas al pic, los bornes, las resistencias, el boton conectado al puerto 1, el diamante, etc\\

%-----------------------------------------
% Max232 y Serial
%-----------------------------------------
\subsubsection{MAX232 y Conexión Serial}
El MAX232 tiene como funcion convertir las señales del puerto serial RS-232 a TTL para ser usadas por el PIC y viceversa. Tiene 16 pines que seran explicados a continuacion (Ver el pic \ref{fig:max232} y sus pines \ref{tbl:pinesmax232}):
%-----------------------------------------
\begin{figure}
	\label{fig:max232}
	\begin{center}
		\includegraphics[scale=1]{Images/Max232.PNG}	
	\end{center}
	\caption{Diagrama del Max232}
\end{figure}
%-----------------------------------------
\begin{table}
\begin{center}
\label{tbl:pinesmax232}
\begin{tabular}{|c|p{5cm}|c|}
\hline Pin & Descripción & Conexión\\
\hline C1+ & Conexion a un condensador necesaria para su funcionamiento & C1- \\ 
\hline VS+ & Voltaje de salida positivo (-15~-0.3[V]). Se conecta un condensador (1uF) & Tierra \\ 
\hline C1- & Conexion a un condensador (1uF) necesaria para su funcionamiento & C1+ \\ 
\hline C2+ & Conexion a un condensador (1uF) necesaria para su funcionamiento & C2- \\ 
\hline C2- & Conexion a un condensador (1uF) necesaria para su funcionamiento & C2+ \\ 
\hline VS- & Voltaje de salida negativo (-0.3~15[V]) Se conecta un condensador (1uF) & Tierra \\ 
\hline T2OUT & Salida EIA-232 & Puerto serial \\ 
\hline R2IN & Entrada EIA-232 2 & Puerto serial \\ 
\hline R2OUT & Salida TTL/CMOS & Pic16F877A (RC5)\\ 
\hline T2IN & Entrada TTL/CMOS & Pic16F877A (RC4)\\ 
\hline T1IN & Entrada TTL/CMOS & Pic16F877A (RC6)\\ 
\hline R1OUT & Salida TTL/CMOS  & Pic16F877A (RC7)\\ 
\hline R1IN & Entrada EIA-232 1 & Puerto serial \\ 
\hline T1OUT & Salida EIA-232 & Puerto serial \\ 
\hline GND & Cable a tierra & Tierra \\ 
\hline Vcc & Entrada de corriente continua. Entre 4.5 y 5.5 [V] & Fuente de poder \\ 
\hline 
\end{tabular} 
\end{center}
\caption{Descripción de los pines max232}
\end{table}
%----------------------------------------

%----------------------------------------
% Elementos Adicionales
%----------------------------------------
\subsubsection{Elementos Adicionales:}
\begin{description}
	\item[Regulador de voltaje] El regulador de voltaje nos permite mantener un voltaje controlado para los componentes 
\end{description}
%poner el regulador del voltaje, algún pin no conectado al pic, etc, muy corto, una línea\\




\newpage
\Huge{Entrega Anterior:---------------------------------}



\subsection{Descripción general}
El dispositivo a realizar consiste en un controlador de reproducción de música. Básicamente, el controlador recibirá información del ambiente en que se encuentra, y en base a ésta controlará diversos aspectos de la reproducción de la música en un computador.

\subsection{Funcionalidad}
Nuestro dispositivo consistirá en un periférico para computador, el cual será capaz de controlar automáticamente la música que el computador se encuentra reproduciendo y su volumen según el ambiente. Para esto, el dispositivo deberá monitorear el ambiente con el fin de detectar cambios en la intensidad de luz y del ruido ambiental, regulando el tipo de música que se reproducirá y su volumen.
Por ejemplo, si la luz ambiental es fuerte se tocará música movida, y si el ruido ambiental es bajo el volumen también lo será. De esta forma, nuestro dispositivo captará en cierta manera la \textit{vibra} del ambiente y así reproducirá la música adecuada.\\

Adicionalmente al control automático de la música, el dispositivo permitirá comenzar y pausar la reproducción cuando el usuario lo desee, como también adelantar y retroceder de canción. Junto con lo anterior, el usuario podrá programar un tiempo en que el dispositivo pueda iniciar o detener automáticamente la reproducción. El tiempo ingresado se mostrará al usuario en una pantalla en conjunto con el nombre de la canción que se está reproduciendo.\\

El dispositivo y las canciones que se reproducirán para las distintas \textit{vibras} presentes en el ambiente se podrán configurar desde un PC.\\

\subsection{Características}
Para poder realizar las funcionalidades definidas en el apartado anterior, el periférico debe estar compuesto por diferentes dispositivos. En primer lugar debe poseer un sensor que le permita detectar el ruido ambiente. De esta forma, cuando el ruido ambiente aumenta, el dispositivo determina un aumento del volumen de la música que está reproduciendo el computador. Junto con lo anterior, el dispositivo debe tener un sensor lumínico el cual permita medir la luminosidad del ambiente, determinando qué tipo de música reproducir. Luego, a través del análisis de los datos entregados por los dos sensores anteriores, el dispositivo controlará la reproducción de la música.\\

Otra parte esencial del periférico es dar información al usuario. Para este fin utilizaremos una pantalla LCD de 16x2 caracteres, en la cual se mostrará tanto la información de la canción que se está reproduciendo (proporcionada por el computador y transmitida por el microcontrolador) como el tiempo restante en el timer de encendido/apagado.\\

Finalmente, usaremos varios botones que permiten controlar la reproducción. Estos son los típicos de cualquier reproductor: play/pause, stop, forward y backward. De esta manera el usuario podrá controlar la reproducción de las canciones, pero siempre dentro del playlist definido por el microcontrolador a través de la información del ambiente. Incluimos además dos botones para controlar el \textit{timer}: uno para aumentar el tiempo y otro para resetearlo, de manera que el usuario pueda ingresar el tiempo que desee (en minutos preferentemente).\\

 
\newpage 
\section{Dispositivos a utilizar}
La siguiente tabla resume los dispositivos que se utilizarán en la construcción del proyecto.

Para más información, es posible hacer click en las tiendas y datasheets.
\begin{table}[h]
	\begin{center}
	\begin{tabular}{|c|c|c|c|c|p{4.0cm}|}
		\hline  Nombre & Código  & Disponibilidad & Precio & Detalles & Uso \\ 
		\hline  Microcontrolador PIC & PIC16F877A & \href{http://www.olimex.cl/product_info.php?products_id=159}{Olimex.cl}  & \verb@$@4,583 & \href{http://ww1.microchip.com/downloads/en/DeviceDoc/39582b.pdf}{datasheet} & Permite ejecutar las instrucciones asociadas a cambios en la luminosidad, el ruido del ambiente y el input del usuario.\\
		\hline  16x2 Character LCD & GDM1602K & \href{http://www.olimex.cl/product_info.php?products_id=154}{Olimex.cl} & \verb@$@7,668 & \href{http://www.olimex.cl/pdf/LCD/GDM1602K.pdf}{datasheet} & Muestra información de la canción actual y del estado del ambiente. \\

		\hline  Sensor de Luz & ZX-LDR & \href{http://www.olimex.cl/product_info.php?cPath=50_89&products_id=340}{Olimex.cl} & \verb@$@3,934 & \href{http://www.olimex.cl/pdf/ZX-LDR.pdf}{datasheet} & Detecta los niveles de luminosidad del ambiente. \\ 

		\hline  Sensor de sonidos & ZX-Sound & \href{http://www.olimex.cl/product_info.php?cPath=50_95&products_id=408}{Olimex.cl} & \verb@$@4,900 & \href{http://www.olimex.cl/pdf/INEX/ZX-sound_e.pdf}{datasheet} & Detecta el nivel de ruido ambiental. \\
		\hline  Pulsadores & SP-1116 & \href{http://www.casaroyal.cl/?seccion_id=FICHA&product_id=3718&category_id=1030}{Casa Royal} & \verb@$@100 c/u & - & Botones de play/pause, stop, backward, forward. \\
		\hline
	
	\end{tabular}
	\end{center}
\end{table}

\subsection{Microcontrolador PIC}
\subsubsection{Datos Básicos}
	\begin{itemize}
		\item Modelo: PIC16F877A
		\item Fabricante: Microchip
		\item Descripción: Microcontrolador programable de 8 bits (bus de datos. Implementa la arquitectura harvard y utiliza 
	\end{itemize}
	
\subsubsection{Características}
	\begin{itemize}
		\item Program Memory Type:	 Flash
 		\item Program Memory (KB):	 14
 		\item CPU Speed (MIPS):	 5
 		\item RAM Bytes:	 368
 		\item Data EEPROM (bytes):	 256
 		\item Digital Communication Peripherals:	 1-A/E/USART, 1-MSSP(SPI/I2C)
 		\item Capture/Compare/PWM Peripherals:	 2 CCP
 		\item Timers:	 2 x 8-bit, 1 x 16-bit
 		\item ADC:	 8 ch, 10-bit
 		\item Comparators:	 2
		\item Temperature Range (C):	 -40 to 125
 		\item Operating Voltage Range (V):	 2 to 5.5
		\item Pin Count	 40
	\end{itemize}
	
\subsubsection{Aplicación}
	El microcontrolador se encargará de ejecutar las instrucciones correspondientes en función de los cambios detectados en los diferentes dispositivos del sistema (computador principal y sensores). A continuación se presenta una lista con las funcionalidades que esperamos implementar utilizando el microcontrolador:
	
	\begin{itemize}
		 \item \textbf{Detectar cambios en el ambiente:} A partir de la señal enviada desde los sensores, el microcontrolador deberá ejecutar instrucciones que produzcan cambios a nivel de software en el computador principal. Por ejemplo, cambiar la canción cuando la intensidad de la luz aumente/disminuya o bien cambiar el volúmen según el ruido del ambiente.
		 \item \textbf{Comunicación bi-direccional con el pc:} El computador deberá enviar información sobre la canción actual que se está reproduciendo al microcontrolador y éste último deberá enviar la información sobre el ambiente, a partir de lo cual se decidirá la lista a reproducir y el volumen de la reproducción. También deberá notificar al computador si el usuario pulso alguno de los botones, a fin de ejecutar las instrucciones play/pause, stop, backward (canción anterior) y forward (siguiente canción). En principio, la comunicación se realizará a través del puerto serial.
		 \item \textbf{Configurar el sistema:} Transformar input a la interfaz gráfica o a los controles físicos en instrucciones que permitan, por ejemplo, cambiar los niveles de intensidad de luz o ruido para los cuales se reproduce cierto tipo de música.
		 \item \textbf{Modificar el display de la información:} Cada vez que se detecte un cambio en las variables sensadas o en la canción que se está reproduciendo, el microcontrolador deberá enviar la información a los dispositivos de display (16x2 character LCD y monitor del pc) de tal forma que éstos muestren información actualizada sobre el estado del sistema.
		 \item \textbf{Controlar tiempos:} El sistema debe ser capaz de prenderse o apagarse automáticamente según el tiempo ingresado por el usuario al pulsar un botón. Para esto el microcontrolador recibirá la información y utilizando el timer deberá prender/apagar el sistema cuando llegue al tiempo definido.
	\end{itemize}
	
\subsection{16x2 Character LCD}
\subsubsection{Características}
Utiliza el ampliamente conocido chip HD44780 para su interfaz en paralelo. El código para la interfaz está disponible gratuitamente. Se necesitan aproximadamente 11 pines I/O para controlar la pantalla LCD. Incluye un LED Backlight (para alumbrar el fondo de la pantalla).\footnote{Descripción obtenida de \href{http://www.olimex.cl/product_info.php?products_id=154}{Olimex.cl}.}

\subsubsection{Aplicación}
Se utilizará para mostrar información sobre la canción que se está reproduciendo, el estado de los sensores (intensidad alta/media/baja) y el tiempo del \textit{timer}. Esta información deberá ser enviada desde el microcontrolador. 

\subsection{Sensores de Luz y de sonidos}
\subsubsection{Características}
Ambos sensores tienen una salida que devuelve un voltaje cuyo valor refleja la intensidad capturada.

\subsubsection{Aplicación}
Se encargan de capturar la intensidad lumínica y sonora del ambiente respectivamente, y enviaran la señal de voltaje correspondiente hacia el microcontrolador. La información de la intensidad será digitalizada por el microcontrolador. Según el rango en el cual se encuentre el voltaje, el microcontrolador le indicará al computador los niveles de intensidad, los que pueden tomar 3 valores posibles: alto, medio y bajo. Luego la canción a reproducir y el volumen serán determinados a partir de los niveles de intensidad.

\end{document}